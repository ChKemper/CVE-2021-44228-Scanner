package de.atruvia.scanner;

import java.util.ArrayList;
import java.util.List;

/**
 * Wrapper for startup class to adress internal compliance
 */
public class Log4j2Scanner {

    public static void main(String[] args) {
        System.out.println("Atruvia version of Logpresso Scanner: https://github.com/atruvia/CVE-2021-44228-Scanner");

        boolean scanZip = true;
        boolean scanLog4j_1 = true;
        List<String> newArgs = new ArrayList<String>();

        if(args != null && args.length == 0) {
            com.logpresso.scanner.Log4j2Scanner.main(args);
            return;
        }
        else if(args != null) {
            for (String arg : args) {
                if("--fix".equalsIgnoreCase(arg)) {
                    System.out.println("--fix not supported in internal scope! Removing parameter.");
                }
                else if("--skip-zip".equalsIgnoreCase(arg)) {
                    scanZip = false;
                }
                else if("--skip-log4j1".equalsIgnoreCase(arg)) {
                    scanLog4j_1 = false;
                }
                else {
                    newArgs.add(arg);
                }
            }
            if(scanZip) {
                newArgs.add(0, "--scan-zip");
            }
            if(scanLog4j_1) {
                newArgs.add(0, "--scan-log4j1");
            }
            com.logpresso.scanner.Log4j2Scanner.main(newArgs.toArray(new String[newArgs.size()]));
        }
        else {
            com.logpresso.scanner.Log4j2Scanner.main(args);
        }
    }
}
